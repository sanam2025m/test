    :root{
      --brand:#4d2c12; --ink:#000; --muted:#ccc; --paper:#fff; --field:#fdf4e8;
      --page-padding:20mm;      /* حاشية داخلية للصفحات غير الغلاف */
      --rows-per-page:40;       /* تقدير مبدئي (سنستخدم قياسًا ديناميكيًا) */
    }

    html,body{
      margin:0; padding:0; height:100%;
      background:var(--paper); color:var(--ink);
      font-family:'Cairo',sans-serif;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      -webkit-print-color-adjust:exact; print-color-adjust:exact;
    }

    .app{min-height:100vh; display:flex; flex-direction:column;}
    .toolbar{
      position:sticky; top:0; z-index:1000;
      display:flex; justify-content:center; gap:12px; padding:12px;
      background:linear-gradient(to bottom, rgba(0,0,0,.04), rgba(0,0,0,0));
      backdrop-filter:blur(4px);
    }
    .toolbar button{
      padding:10px 20px; font-size:16px; background:var(--brand); color:#fff;
      border:0; border-radius:10px; cursor:pointer;
    }

    .content{width:min(1200px,100%); margin:0 auto; padding:16px; box-sizing:border-box;}
    .card{background:#fff; border:1px solid var(--muted); border-radius:14px; box-shadow:0 4px 20px rgba(0,0,0,.04); padding:18px; margin-bottom:16px;}
    .header{display:flex; justify-content:space-between; align-items:center; border-bottom:2px solid #eee; padding-bottom:10px; margin-bottom:10px;}
    .header img{height:90px;}
    h1,h2{text-align:center; color:var(--brand); margin:8px 0;}
    .input-grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:12px 16px; align-items:end;}
    .input-line label{font-weight:700; display:block; margin-bottom:4px;}
    input[type="text"],input[type="date"]{
      width:100%; border:1px solid #ddd; background:var(--field); font-size:16px;
      padding:8px 10px; border-radius:10px; box-sizing:border-box;
    }
    .cover-config{display:grid; grid-template-columns:1fr; gap:8px;}
    table{width:100%; border-collapse:collapse; table-layout:fixed;}
    th,td{border:1px solid #ddd; padding:6px; text-align:center; font-size:12px; word-wrap:break-word; word-break:break-word; white-space:pre-wrap;}
    .muted{color:#666;}
    .print-only{display:none;}

 /* ===================== الطباعة A4 ===================== */
@page { size: A4; margin: 0; }

@media print{
  /* exact A4 canvas */
  html, body{
    margin: 0 !important;
    width: 210mm; height: 291mm;
    overflow: visible;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

/* ===================== تخصيص إخفاء الأعمدة لكل جدول ===================== */

/* جدول الحالات الأمنية: إخفاء العمود الأول فقط (الطابع الزمني) */
.cases-table thead th:nth-child(1),
.cases-table tbody td:nth-child(1){
  display: none !important;
}

/* جدول الحضور والانصراف: إخفاء الأعمدة 1 و7 و8 و10 و11 و12 */
.attendance-table thead th:nth-child(1),
.attendance-table tbody td:nth-child(1),
.attendance-table thead th:nth-child(7),
.attendance-table tbody td:nth-child(7),
.attendance-table thead th:nth-child(8),
.attendance-table tbody td:nth-child(8),
.attendance-table thead th:nth-child(10),
.attendance-table tbody td:nth-child(10),
.attendance-table thead th:nth-child(11),
.attendance-table tbody td:nth-child(11),
.attendance-table thead th:nth-child(12),
.attendance-table tbody td:nth-child(12){
  display: none !important;
}


  /* ألوان هيدر الجدول */
  thead th{
    background: #CC9D79 !important;
    color: #fff !important;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  /* صفحات الطباعة الأساسية */
  .toolbar, .card.screen-only, .screen-only{ display: none !important; }
  .print-only{ display: block !important; }

  .print-page{
    display: block;
    position: relative;
    box-sizing: border-box;
    width: 210mm; height: 291mm;
    margin: 0 auto;
    padding: 0;
    break-after: auto;
    page-break-after: auto;
    overflow: hidden;
    background: #fff;
    transform: scale(1);
    transform-origin: top left;
  }

  /* لا تبدأ صفحة جديدة إلا من الثالثة */
  .print-page:nth-child(n+3){
    break-before: page;
    page-break-before: always;
  }

  .print-page .page-content{
    padding: var(--page-padding);
    box-sizing: border-box;
    width: 100%; max-width: 100%;
    overflow-x: hidden;
  }

  /* الجداول */
  table{ width:100%; border-collapse:collapse; table-layout:fixed; page-break-inside:auto; break-inside:auto; }
  thead{ display: table-header-group !important; }
  tfoot{ display: table-footer-group !important; }
  tbody{ display: table-row-group; }
  th, td{
    font-size: 12px; border: 1px solid #ccc;
    word-break: break-word; white-space: pre-wrap;
    page-break-inside: avoid; break-inside: avoid;
  }
  img{ max-width:100%; height:auto; }

  /* الغلاف */
  .cover-page,
  .second-page {
    position: relative;
    height: 291mm;
    overflow: hidden;
    background: none !important;
  }

  /* صورة الغلاف فقط */
  .cover-page::before {
    content: "";
    position: absolute;
    inset: 0;
    height: calc(100% - 0.2mm);
    width: calc(100% - 0.2mm);
    background-color: #fdf4e8;
    background-image: url('cover-page1.png');
    background-repeat: no-repeat;
    background-position: center center;
    background-size: 210mm 288mm;
    pointer-events: none;
  }

  /* ⚠️ تمت إزالة صورة الخلفية من الصفحة الثانية.
     نُلوّن خلفيتها كالصفحات التالية: */
  #printRoot > .print-page:nth-child(2){
    background-color: #fdf4e8 !important;
  }

  /* من الصفحة الثالثة فصاعدًا نفس اللون */
  #printRoot > .print-page:nth-child(n+3){
    background-color: #fdf4e8 !important;
  }

  /* شعار سنام في رأس الصفحات 3+ (اختياري) */
  #printRoot > .print-page:nth-child(n+3)::after{
    content: "";
    position: absolute;
    top: 10mm;
    right: var(--page-padding);
    width: 45mm;
    height: 28mm;
    background: url('logo_sanam.png') no-repeat center / contain;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  #printRoot > .print-page:nth-child(n+3) .page-content{
    padding-top: calc(var(--page-padding) + 18mm);
    background: transparent !important;
  }

  /* صفحات الجداول: مسافة سفلية إضافية */
  .table-page .page-content{
    padding-bottom: calc(var(--page-padding) + 20mm);
  }

  /* عناوين الجداول داخل الهوامش */
  #printRoot > .print-page.table-page .page-content > h2{
    padding-inline: var(--page-padding);
    margin-top: var(--page-padding);
    margin-bottom: 6mm;
  }
}
